{
    "$schema": "https://vega.github.io/schema/vega-lite/v4.json",

    "width": 400,
    "height": 400,

    "data": {
      "values": [
        {"A": "Opioid Prescription(P)", "B": " ", "count": 2, "Set": "P"},
        {"A": "Opioid Prescription(P)", "B": "Justice Involvement(J)", "count": 0, "Set": "P∩J"},
        {"A": "Opioid Prescription(P)", "B": "J∩H", "count": 218, "Set": "P∩J∩H"},
        {"A": "Opioid Prescription(P)", "B": "Health Data(H)", "count": 887, "Set": "P∩H"},
        {"A": "P∩O", "B": " ", "count": 0, "Set": "P∩O"},
        {"A": "P∩O", "B": "Justice Involvement(J)", "count": 0, "Set": "P∩O∩J"},
        {"A": "P∩O", "B": "J∩H", "count": 95, "Set": "P∩O∩J∩H"},
        {"A": "P∩O", "B": "Health Data(H)", "count": 99, "Set": "P∩O∩H"},
        {"A": "Overdose(O)", "B": " ", "count": 25, "Set": "O"},
        {"A": "Overdose(O)", "B": "Justice Involvement(J)", "count": 17, "Set": "O∩J"},
        {"A": "Overdose(O)", "B": "J∩H", "count": 25, "Set":"O∩J∩H"},
        {"A": "Overdose(O)", "B": "Health Data(H)", "count": 28, "Set": "O∩H"},
        {"A": " ", "B": " ", "count": 473, "Set": " "},
        {"A": " ", "B": "Justice Involvement(J)", "count": 63, "Set": "J"},
        {"A": " ", "B": "J∩H", "count": 78, "Set": "J∩H"},
        {"A": " ", "B": "Health Data(H)", "count": 321, "Set": "H"}
      ]
    },

    "encoding": {
      "y": {"field": "A", "type": "ordinal", "sort": ["Opioid Prescription(P)", "P∩O", "Overdose(O)", " "], "title": null},
      "x": {"field": "B", "type": "ordinal", "sort": [" ", "Justice Involvement(J)", "J∩H", "Health Data(H)"], "title": null}
    },
    
    "layer": [
      {
        "selection": {
          "highlight": {"type": "single"}
        },
        "mark": {"type": "rect", "strokeWidth": 2},
        "encoding": {
          "fill": {
            "field": "count",
            "type": "quantitative",
            "condition": {"test": "datum['count'] == 0", "value": "white"}
          },
          "stroke": {
            "condition": {"test": {"and": [{"selection": "highlight"}, "length(data(\"highlight_store\"))"]}, "value": "black"},
            "value": null
          },
          "opacity": {
            "condition": {"selection": "highlight", "value": 1},
            "value": 0.5
          }
        }
      },
      {
        "mark": "text",
        "encoding": {
          "text": {"field": "Set", "type": "nominal"},
          "color": {
            "condition": {"test": "datum['count'] < 400", "value": "black"},
            "value": "white"
          }
        }
      }
    ],
    
    "config": {
      "scale": {
        "bandPaddingInner": 0,
        "bandPaddingOuter": 0
      },
      "view": {"step": 40},
      "axis": {
        "domain": false
      }
    }
  }