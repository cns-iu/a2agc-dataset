{
    "$schema": "https://vega.github.io/schema/vega-lite/v4.json",

    "width": 400,
    "height": 400,

    "data": {
      "url": "../data/visualization2/data.csv"
    },

    "encoding": {
      "y": {"field": "Touchpoint A", "type": "ordinal", "sort": ["Opioid Prescription(P)", "P∩O", "Overdose(O)", "∅"], "title": null},
      "x": {"field": "Touchpoint B", "type": "ordinal", "sort": ["∅", "Justice Involvement(J)", "J∩H", "Health Data(H)"], "title": null}
    },
    
    "layer": [
      {
        "selection": {
          "highlight": {"type": "single"}
        },
        "mark": {"type": "rect", "strokeWidth": 2},
        "encoding": {
          "fill": {
            "field": "count",
            "type": "quantitative",
            "condition": {"test": "datum['count'] == 0", "value": "white"}
          },
          "stroke": {
            "condition": {"test": {"and": [{"selection": "highlight"}, "length(data(\"highlight_store\"))"]}, "value": "black"},
            "value": null
          },
          "opacity": {
            "condition": {"selection": "highlight", "value": 1},
            "value": 0.5
          }
        }
      },
      {
        "mark": "text",
        "encoding": {
          "text": {"field": "Set", "type": "nominal"},
          "color": {
            "condition": {"test": "datum['count'] < 400", "value": "black"},
            "value": "white"
          }
        }
      }
    ],
    
    "config": {
      "scale": {
        "bandPaddingInner": 0,
        "bandPaddingOuter": 0
      },
      "view": {"step": 40},
      "axis": {
        "domain": false
      }
    }
  }