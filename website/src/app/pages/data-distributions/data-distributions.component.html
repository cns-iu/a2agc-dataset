<div class="header">Data Distributions</div>

<agc-table-data-selector [subLabel]="(subLabel$ | async) ?? ''" [datasets]="(datasets$ | async) ?? []"
                         [variables]="(variables$ | async) ?? []" [subVariables]="(subVariables$ | async) ?? []"
                         (datasetChange)="setSelectedDataset($event)" (dataVariableChange)="setSelectedVariable($event)"
                         (selectAll)="setSelectAllVariables()">
</agc-table-data-selector>

<div class="data-block" *ngIf="visualizations.length !== 0">
  <div *ngFor="let vis of visualizations" class="visualization">
    <agc-lazy-visualization *ngIf="hasSpec(vis); else: summary" dataBindingName="distribution" [spec]="vis.spec"
                            [autosize]="autosize" [data]="(vis.data | async) ?? []">
    </agc-lazy-visualization>

    <ng-template #summary>
      <agc-dataset-summary [summary]="vis.metadata | async" [title]="vis.variable.name">
      </agc-dataset-summary>
    </ng-template>
  </div>

  <ngx-vega *ngIf="showTimeSlider" class="time-slider" [class.sticky]="visualizations.length > 1"
            [spec]="timeSliderSpec!" [autosize]="autosize" [options]="{ actions: false }"
            (viewChange)="attachPeriodSelector($event)">
  </ngx-vega>
</div>
